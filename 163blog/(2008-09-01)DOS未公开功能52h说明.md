# DOS未公开功能52h说明  
**2008-09-01 12:40:51**

> 在DOS int 21h中，有一个非常有用的未公开的功能，功能号是52h，其实我们在前面的一篇文章《如何写DOS下的设备驱动程序（二）》中已经用到过，我一直不想写这个功能，是因为这个功能返回的许多东西我也从来没有用到过，所以不敢说到底是什么东西，因为要写《从命令行加载设备驱动程序》这篇文章，里面不得不多次用到这个功能返回的东西，所以索性把我保存的资料中关于这个功能的内容罗列出来。

> 功能：获得指向DOS内部重要信息表
  ```
    入口：ah=52h
          int 21h
    出口：ES:BX指向DOS内部重要信息表
    下面是这个DOS内部重要信息表的内容
    偏移    大小     描述
    ------------------------------------------------------------------
    -12     word     (DOS 3.1-5.0)共享重试次数
    -10     word     (DOS 3.1-5.0)共享重试延迟
    -8      dword    (DOS 3.x)当前磁盘缓冲区指针
    -4      word     (DOS 3.x)
    -2      word     第一个内存控制块段
    00h     dword    指向第一个驱动器控制块DPB的指针
    04h     dword    指向第一个系统文件表SFT的指针
    08h     dword    指向现用CLOCK$设备标题的指针
    0ch     dword    指向现用CON设备标题的指针
    10h     word     块设备的每扇区最大字节数
    12h     dword    指向磁盘缓冲信息记录的指针
    16h     dword    指向当前目录结构（CDS）的数组的指针
    1ah     dword    指向系统FCB表的指针
    1eh     word     保护模式下的FCB数
    20h     byte     安装的块设备数
    21h     byte     可用的驱动器字母数（config.sys中lastdrive=）
    22h     18bytes  NUL设备驱动程序标题头
    34h     byte     连接的驱动器数
    35h     word     在IBMDOS代码段内指向特殊程序名清单的指针
    37h     dword    指向驻留IFS公用功能FAR例程的指针
    3bh     dword    指向IFS驱动程序链的指针
    3fh     word     BUFFERSx,y中的x
    41h     word     BUFFERSx,y中的y
    43h     byte     引导驱动器（1=A:）
    44h     byte     80286+为01h，否则为00h
    45h     byte     以K计的扩展内存容量
  ```
> 我在下面要完成的《从命令行加载设备驱动程序》一文中要用到偏移为[10h]、[16h]、[20h]、[21h]、[22h]的几个字段。
   
